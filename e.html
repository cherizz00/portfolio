<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Asteria ‚Äî AI Commerce Demo</title>
<style>
/* ====== CSS: Premium clean UI ====== */
:root{
  --bg:#0b0c0e; --panel:#101217; --muted:#6b7280; --text:#e5e7eb; --brand:#8b5cf6; --brand-2:#22d3ee; --ok:#10b981; --warn:#f59e0b; --danger:#ef4444;
  --ring: 0 0 0 1px rgba(139,92,246,.4), 0 0 0 6px rgba(139,92,246,.12);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  color:var(--text); background: radial-gradient(1200px 600px at 80% -10%, rgba(34,211,238,.12), transparent 60%),
                      radial-gradient(900px 500px at -10% -10%, rgba(139,92,246,.12), transparent 60%),
                      var(--bg);
}
a{color:inherit; text-decoration:none}
.container{max-width:1200px; margin:0 auto; padding:0 16px}
.header{
  position:sticky; top:0; z-index:20; backdrop-filter:saturate(1.2) blur(8px);
  background: linear-gradient(to bottom, rgba(16,18,23,.9), rgba(16,18,23,.6) 60%, transparent);
  border-bottom:1px solid rgba(255,255,255,.06);
}
.header-inner{display:flex; align-items:center; gap:12px; height:64px}
.logo{
  font-weight:800; letter-spacing:.3px; background: linear-gradient(90deg, #fff, #a78bfa 45%, #67e8f9);
  -webkit-background-clip:text; background-clip:text; color:transparent; font-size:20px
}
.search{
  flex:1; display:flex; align-items:center; gap:8px; background:#0d1016; border:1px solid rgba(255,255,255,.08);
  border-radius:10px; padding:10px 12px; transition:.2s ease; box-shadow: 0 0 0 rgba(0,0,0,0);
}
.search:focus-within{box-shadow: var(--ring); border-color: rgba(139,92,246,.4)}
.search input{
  flex:1; background:transparent; border:0; outline:0; color:var(--text); font-size:14px;
}
.btn{
  background: linear-gradient(180deg, #111827, #0b0f17); border:1px solid rgba(255,255,255,.10);
  color:#e5e7eb; padding:10px 14px; border-radius:10px; cursor:pointer; transition:.2s ease;
}
.btn:hover{transform:translateY(-1px); border-color: rgba(139,92,246,.4)}
.btn.primary{
  background: linear-gradient(180deg, #7c3aed, #6d28d9); border-color: rgba(139,92,246,.6);
}
.badge{font-size:11px; padding:3px 8px; border:1px solid rgba(255,255,255,.12); border-radius:9999px; color:#cbd5e1}
.grid{display:grid; gap:16px}
.grid.products{grid-template-columns:repeat(2,minmax(0,1fr))}
@media(min-width:900px){.grid.products{grid-template-columns:repeat(4,minmax(0,1fr))}}
.card{
  background:linear-gradient(180deg, #0f131a, #0b0f16); border:1px solid rgba(255,255,255,.08);
  border-radius:14px; overflow:hidden; transition:.25s ease; position:relative;
}
.card:hover{transform:translateY(-2px); border-color: rgba(139,92,246,.35); box-shadow: 0 10px 40px rgba(139,92,246,.08)}
.card-media{
  aspect-ratio:1/1; background:linear-gradient(135deg, rgba(139,92,246,.25), rgba(34,211,238,.25));
  display:flex; align-items:center; justify-content:center; position:relative;
}
.card-media .swatch{
  position:absolute; right:10px; top:10px; width:14px; height:14px; border-radius:50%; border:2px solid rgba(0,0,0,.4); box-shadow:0 0 0 2px rgba(255,255,255,.15);
}
.card-body{padding:12px}
.card-title{font-weight:700; font-size:14px; line-height:1.25; margin-bottom:6px}
.card-desc{color:var(--muted); font-size:12px; min-height:32px}
.row{display:flex; align-items:center; justify-content:space-between; gap:8px; margin-top:10px}
.price{font-weight:800}
.price small{opacity:.7; font-weight:600; margin-left:2px}
.kicker{display:flex; align-items:center; gap:8px; margin:18px 0 10px}
.kicker h2{margin:0; font-size:16px; font-weight:800}
.kicker .line{flex:1; height:1px; background: linear-gradient(90deg, rgba(255,255,255,.12), transparent)}
.section{padding:22px 0}
.toolbar{display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin:8px 0 18px}
.select, .input{
  background:#0d1016; border:1px solid rgba(255,255,255,.08); color:var(--text); border-radius:10px; padding:8px 10px; font-size:13px;
}
.footer{padding:32px 0; color:#94a3b8; border-top:1px solid rgba(255,255,255,.06); margin-top:40px}
.skel{background:linear-gradient(90deg, rgba(255,255,255,.05), rgba(255,255,255,.02) 40%, rgba(255,255,255,.05)); background-size:300% 100%; animation:sh 1.2s infinite}
@keyframes sh{0%{background-position:0 0}100%{background-position:-300% 0}}
/* Drawer/Chat */
.drawer{position:fixed; right:16px; bottom:16px; width:320px; max-width:92vw; background:#0d1016; border:1px solid rgba(255,255,255,.1); border-radius:14px; overflow:hidden; box-shadow:0 20px 60px rgba(0,0,0,.5)}
.drawer header{padding:10px 12px; display:flex; align-items:center; justify-content:space-between; background:#0b0f16; border-bottom:1px solid rgba(255,255,255,.08)}
.drawer .content{max-height:45vh; overflow:auto; padding:12px}
.msg{font-size:13px; line-height:1.4; margin:6px 0; display:flex; gap:8px}
.msg .bubble{padding:8px 10px; border-radius:10px; max-width:85%}
.msg.user .bubble{background:#1f2937}
.msg.bot .bubble{background:#0a0e14; border:1px solid rgba(139,92,246,.35)}
.chat-input{display:flex; gap:8px; border-top:1px solid rgba(255,255,255,.08); padding:10px 12px}
.chat-input input{flex:1; background:#0b0f16; border:1px solid rgba(255,255,255,.08); border-radius:10px; padding:10px; color:var(--text)}
.fabs{display:flex; gap:8px}
.fab{position:fixed; right:16px; bottom:16px; width:48px; height:48px; border-radius:12px; background:linear-gradient(180deg,#7c3aed,#6d28d9); display:grid; place-items:center; color:#fff; cursor:pointer; box-shadow:0 18px 40px rgba(124,58,237,.3)}
/* Visual search dropzone */
.dropzone{border:1px dashed rgba(255,255,255,.18); border-radius:12px; padding:10px 12px; font-size:12px; color:#9ca3af}
.dropzone.drag{background:rgba(139,92,246,.08); border-color:rgba(139,92,246,.4)}
/* Cart mini */
.cart{
  position:fixed; right:80px; bottom:16px; min-width:280px; background:#0d1016; border:1px solid rgba(255,255,255,.1); border-radius:14px; overflow:hidden; display:none;
}
.cart header{padding:10px 12px; font-weight:800; border-bottom:1px solid rgba(255,255,255,.08)}
.cart .body{max-height:40vh; overflow:auto; padding:10px 12px}
.cart .row{margin:8px 0}
.cart .total{padding:12px; border-top:1px solid rgba(255,255,255,.08); display:flex; justify-content:space-between}
.small{font-size:12px; color:#94a3b8}
</style>
</head>
<body>

<header class="header">
  <div class="container header-inner">
    <div class="logo">Asteria</div>
    <div class="search" id="searchBar">
      <svg width="16" height="16" fill="#94a3b8" viewBox="0 0 24 24"><path d="M10 2a8 8 0 105.293 14.293l4.707 4.707 1.414-1.414-4.707-4.707A8 8 0 0010 2zm0 2a6 6 0 110 12 6 6 0 010-12z"/></svg>
      <input id="q" placeholder="Search products‚Ä¶ try ‚Äúwhite sneakers‚Äù, ‚Äúdenim‚Äù, or drop an image below">
      <button class="btn" id="clearBtn">Clear</button>
    </div>
    <button class="btn" id="cartBtn">Cart</button>
  </div>
</header>

<main class="container">
  <section class="section">
    <div class="toolbar">
      <span class="badge">AI features</span>
      <div class="dropzone" id="dropzone">Drop an image here for visual search</div>
      <select class="select" id="filterCat">
        <option value="">All categories</option>
        <option value="shoes">Shoes</option>
        <option value="outerwear">Outerwear</option>
        <option value="tops">Tops</option>
      </select>
      <select class="select" id="sortBy">
        <option value="relevance">Sort: Relevance</option>
        <option value="price-asc">Sort: Price ‚Üë</option>
        <option value="price-desc">Sort: Price ‚Üì</option>
        <option value="new">Sort: New</option>
      </select>
    </div>

    <div class="kicker"><h2>Results</h2><div class="line"></div></div>
    <div class="grid products" id="grid"></div>

    <div class="kicker"><h2>Trending</h2><div class="line"></div></div>
    <div class="grid products" id="trending"></div>

    <div class="kicker"><h2>Similar to your views</h2><div class="line"></div></div>
    <div class="grid products" id="similar"></div>
  </section>
</main>

<!-- Assistant -->
<div class="fab" id="chatFab" title="Shopping assistant">ü§ñ</div>
<div class="drawer" id="chatDrawer" style="display:none">
  <header>
    <div>Shopping Assistant</div>
    <div class="fabs">
      <button class="btn small" id="closeChat">Close</button>
    </div>
  </header>
  <div class="content" id="chatContent">
    <div class="msg bot"><div class="bubble">Hi! Ask for ‚Äúrunning shoes under $100‚Äù or ‚Äúcompare denim jackets vs hoodies‚Äù. I will recommend from the current catalog.</div></div>
  </div>
  <div class="chat-input">
    <input id="chatInput" placeholder="Ask about size, fit, budget, or product comparisons‚Ä¶">
    <button class="btn primary" id="chatSend">Send</button>
  </div>
</div>

<!-- Cart -->
<div class="cart" id="cart">
  <header>Cart</header>
  <div class="body" id="cartBody"></div>
  <div class="total"><div>Total</div><div id="cartTotal">$0.00</div></div>
</div>

<script>
/* ====== JS: Data and utilities ====== */
const PRODUCTS = [
  {id:"p1", title:"Classic White Sneakers", desc:"Minimal leather, casual wear, everyday comfort.", price:89, cat:"shoes", color:"#f5f5f5", created:"2025-08-20", tags:["shoes","leather","white","minimal"], embedding:[0.82,0.10,0.05,0.03]},
  {id:"p2", title:"Denim Jacket", desc:"Vintage fit, blue wash, all-season staple.", price:129, cat:"outerwear", color:"#27527a", created:"2025-08-11", tags:["jacket","denim","blue","outerwear"], embedding:[0.12,0.80,0.02,0.06]},
  {id:"p3", title:"Performance Running Shoes", desc:"Lightweight mesh, responsive midsole, road-ready.", price:99, cat:"shoes", color:"#b7c1ff", created:"2025-09-10", tags:["running","sport","mesh","shoes"], embedding:[0.78,0.08,0.09,0.05]},
  {id:"p4", title:"Merino Hoodie", desc:"Temperature regulating, odor resistant, travel-friendly.", price:149, cat:"tops", color:"#1b1f29", created:"2025-07-22", tags:["hoodie","merino","wool","black"], embedding:[0.06,0.10,0.80,0.04]},
  {id:"p5", title:"Leather Chelsea Boots", desc:"Premium pull-on boot with rubber outsole.", price:179, cat:"shoes", color:"#5a3b2e", created:"2025-06-01", tags:["boots","leather","chelsea","brown"], embedding:[0.70,0.12,0.08,0.10]},
  {id:"p6", title:"Lightweight Windbreaker", desc:"Packable shell, water-resistant finish.", price:89, cat:"outerwear", color:"#3aa8a0", created:"2025-09-02", tags:["jacket","shell","windbreaker","mint"], embedding:[0.10,0.75,0.07,0.08]},
  {id:"p7", title:"Heavyweight Overshirt", desc:"Brushed cotton, chore pockets, rugged style.", price:119, cat:"tops", color:"#746b5b", created:"2025-05-19", tags:["shirt","overshirt","cotton","khaki"], embedding:[0.09,0.65,0.15,0.11]},
  {id:"p8", title:"Retro Court Sneakers", desc:"Suede panels, 80s silhouette, gum sole.", price:109, cat:"shoes", color:"#d9d1c6", created:"2025-08-05", tags:["sneakers","suede","retro","beige"], embedding:[0.77,0.09,0.07,0.07]},
];

const SESSION = {views: new Set(), cart: []};

/* Text helpers */
const normalize = s => s.toLowerCase().replace(/[^a-z0-9\s]/g,' ');
function tokenize(s){ return normalize(s).split(/\s+/).filter(Boolean); }
function priceFmt(n){ return `$${n.toFixed(2)}`; }

/* Simple hybrid relevance:
   - keyword score (TF-like)
   - semantic score via cosine with tiny faux embeddings computed from query keywords */
function queryEmbedding(q){
  // map coarse concepts -> embedding indices
  const map = { shoe:0, sneakers:0, running:0, denim:1, jacket:1, outerwear:1, hoodie:2, wool:2, warm:2, retro:0, leather:0, boots:0, wind:1, shell:1 };
  const v = [0,0,0,0]; tokenize(q).forEach(t=>{ if(map[t]!=null) v[map[t]] += 1; });
  const norm = Math.hypot(...v)||1; return v.map(x=>x/norm);
}
function cosine(a,b){
  let dot=0,na=0,nb=0;
  for(let i=0;i<a.length;i++){ dot+=a[i]*b[i]; na+=a[i]*a[i]; nb+=b[i]*b[i]; }
  return dot/(Math.sqrt(na)*Math.sqrt(nb)||1);
}
function keywordScore(prod, qTokens){
  const text = tokenize([prod.title, prod.desc, ...(prod.tags||[])].join(' '));
  let score = 0; for(const t of qTokens){ score += text.includes(t)? 1 : 0; }
  return score;
}
function relevance(prod, q){
  if(!q) return 0.5;
  const qTok = tokenize(q);
  const kw = keywordScore(prod, qTok);
  const embQ = queryEmbedding(q);
  const sem = cosine(embQ, prod.embedding||[0,0,0,0]);
  // weighted hybrid
  return 0.65*sem + 0.35*Math.min(1, kw/3);
}

/* Visual search: extract dominant color and match by deltaE-esque distance (simple RGB distance) */
async function imageToColor(file){
  const img = new Image();
  const url = URL.createObjectURL(file);
  await new Promise((res,rej)=>{ img.onload=res; img.onerror=rej; img.src=url; });
  const c = document.createElement('canvas'); c.width=32; c.height=32;
  const ctx = c.getContext('2d'); ctx.drawImage(img,0,0,32,32);
  const data = ctx.getImageData(0,0,32,32).data;
  let r=0,g=0,b=0,n=0;
  for(let i=0;i<data.length;i+=4){ r+=data[i]; g+=data[i+1]; b+=data[i+2]; n++; }
  r=Math.round(r/n); g=Math.round(g/n); b=Math.round(b/n);
  URL.revokeObjectURL(url);
  return {r,g,b};
}
function hexToRgb(hex){
  const m = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
  return m? {r:parseInt(m[1],16), g:parseInt(m[2],16), b:parseInt(m[3],16)} : {r:0,g:0,b:0};
}
function colorDist(a,b){ const dr=a.r-b.r, dg=a.g-b.g, db=a.b-b.b; return Math.sqrt(dr*dr+dg*dg+db*db); }

/* Recommendations */
function similarTo(prodId, n=8){
  const p = PRODUCTS.find(x=>x.id===prodId); if(!p) return [];
  return PRODUCTS
    .filter(x=>x.id!==p.id)
    .map(x=>({p:x, s: cosine(p.embedding,x.embedding)}))
    .sort((a,b)=>b.s-a.s).slice(0,n).map(x=>x.p);
}
function trending(n=8){
  // naive: newest and most viewed
  const viewedCounts = {}; for(const id of SESSION.views){ viewedCounts[id]=(viewedCounts[id]||0)+1; }
  return PRODUCTS
    .slice()
    .sort((a,b)=>{
      const av=(viewedCounts[a.id]||0), bv=(viewedCounts[b.id]||0);
      if(av!==bv) return bv-av;
      return new Date(b.created)-new Date(a.created);
    })
    .slice(0,n);
}

/* ====== Rendering ====== */
const grid = document.getElementById('grid');
const trendingEl = document.getElementById('trending');
const similarEl = document.getElementById('similar');

function productCard(p){
  const el = document.createElement('div');
  el.className='card';
  el.innerHTML = `
    <div class="card-media">
      <div class="swatch" style="background:${p.color}"></div>
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,.6)" stroke-width="1.2">
        <rect x="3" y="3" width="18" height="14" rx="2" />
        <path d="M3 8h18M7 21h10" />
      </svg>
    </div>
    <div class="card-body">
      <div class="card-title">${p.title}</div>
      <div class="card-desc">${p.desc}</div>
      <div class="row">
        <div class="price">${priceFmt(p.price)} <small>USD</small></div>
        <div>
          <button class="btn small add">Add</button>
          <button class="btn small more">More</button>
        </div>
      </div>
    </div>`;
  el.querySelector('.add').onclick = ()=> addToCart(p);
  el.querySelector('.more').onclick = ()=>{
    SESSION.views.add(p.id);
    // update ‚Äúsimilar‚Äù strip
    renderSimilar();
    // scroll to top results and highlight
    el.style.outline = '2px solid rgba(139,92,246,.6)';
    setTimeout(()=> el.style.outline='none', 800);
  };
  return el;
}

function skeletonCards(parent, n=8){
  parent.innerHTML='';
  for(let i=0;i<n;i++){
    const s = document.createElement('div');
    s.className='card';
    s.innerHTML = `<div class="card-media skel"></div><div class="card-body">
      <div class="skel" style="height:14px; width:70%; border-radius:6px"></div>
      <div class="skel" style="height:12px; width:90%; margin-top:6px; border-radius:6px"></div>
      <div class="row"><div class="skel" style="height:14px; width:80px; border-radius:6px"></div>
      <div class="skel" style="height:32px; width:90px; border-radius:8px"></div></div></div>`;
    parent.appendChild(s);
  }
}

function renderResults(list){
  grid.innerHTML='';
  list.forEach(p=>grid.appendChild(productCard(p)));
}
function renderTrending(){ 
  trendingEl.innerHTML=''; trending().forEach(p=>trendingEl.appendChild(productCard(p)));
}
function renderSimilar(){
  const ids = Array.from(SESSION.views);
  if(!ids.length){ similarEl.innerHTML='<div class="small">View a few products to see personalized similar picks.</div>'; return; }
  const base = ids[ids.length-1];
  const sims = similarTo(base, 8);
  similarEl.innerHTML=''; sims.forEach(p=>similarEl.appendChild(productCard(p)));
}

/* ====== Search, filter, sort ====== */
const qEl = document.getElementById('q');
const filterCat = document.getElementById('filterCat');
const sortBy = document.getElementById('sortBy');
const clearBtn = document.getElementById('clearBtn');

function runSearch(){
  const q = qEl.value.trim();
  const cat = filterCat.value;
  let list = PRODUCTS.slice().map(p=>({p, score: relevance(p,q)}));
  if(cat) list = list.filter(x=>x.p.cat===cat);
  // sorting
  const mode = sortBy.value;
  if(mode==='price-asc') list.sort((a,b)=>a.p.price-b.p.price);
  else if(mode==='price-desc') list.sort((a,b)=>b.p.price-a.p.price);
  else if(mode==='new') list.sort((a,b)=> new Date(b.p.created)-new Date(a.p.created));
  else list.sort((a,b)=>b.score-a.score);
  renderResults(list.map(x=>x.p));
}
[qEl, filterCat, sortBy].forEach(el=> el.addEventListener('input', runSearch));
clearBtn.onclick = ()=>{ qEl.value=''; runSearch(); };

/* ====== Visual search (dropzone) ====== */
const dropzone = document.getElementById('dropzone');
['dragenter','dragover'].forEach(evt=> dropzone.addEventListener(evt, e=>{ e.preventDefault(); dropzone.classList.add('drag'); }));
['dragleave','drop'].forEach(evt=> dropzone.addEventListener(evt, e=>{ e.preventDefault(); dropzone.classList.remove('drag'); }));
dropzone.addEventListener('drop', async e=>{
  const file = e.dataTransfer.files?.[0]; if(!file) return;
  const col = await imageToColor(file);
  // rank by color distance
  const ranked = PRODUCTS
    .map(p=>({p, d: colorDist(col, hexToRgb(p.color))}))
    .sort((a,b)=>a.d-b.d)
    .map(x=>x.p);
  grid.innerHTML='';
  ranked.forEach(p=>grid.appendChild(productCard(p)));
});

/* ====== Cart ====== */
const cartBtn = document.getElementById('cartBtn');
const cart = document.getElementById('cart');
const cartBody = document.getElementById('cartBody');
const cartTotal = document.getElementById('cartTotal');

function addToCart(p){
  const existing = SESSION.cart.find(i=>i.id===p.id);
  if(existing) existing.qty += 1; else SESSION.cart.push({id:p.id, title:p.title, price:p.price, qty:1});
  renderCart(); cart.style.display='block';
}
function renderCart(){
  cartBody.innerHTML='';
  let total=0;
  SESSION.cart.forEach(i=>{
    total += i.price * i.qty;
    const row = document.createElement('div'); row.className='row';
    row.innerHTML = `<div class="small">${i.title} √ó ${i.qty}</div>
    <div>${priceFmt(i.price*i.qty)}</div>`;
    cartBody.appendChild(row);
  });
  cartTotal.textContent = priceFmt(total);
}
cartBtn.onclick = ()=>{ cart.style.display = cart.style.display==='block'?'none':'block'; };

/* ====== Assistant (context-aware, no external APIs) ====== */
const chatFab = document.getElementById('chatFab');
const chatDrawer = document.getElementById('chatDrawer');
const closeChat = document.getElementById('closeChat');
const chatContent = document.getElementById('chatContent');
const chatInput = document.getElementById('chatInput');
const chatSend = document.getElementById('chatSend');

chatFab.onclick = ()=> chatDrawer.style.display='block';
closeChat.onclick = ()=> chatDrawer.style.display='none';

function pushMsg(role, text){
  const m = document.createElement('div'); m.className=`msg ${role}`;
  m.innerHTML = `<div class="bubble">${text}</div>`;
  chatContent.appendChild(m); chatContent.scrollTop = chatContent.scrollHeight;
}
function parseBudget(q){
  const m = q.match(/\$?\s?(\d{2,4})/g); if(!m) return null;
  return Math.max(...m.map(x=> Number(x.replace(/\D/g,'')))).valueOf();
}
function recommendFromQuery(q){
  const tokens = tokenize(q);
  const budget = parseBudget(q);
  let list = PRODUCTS.slice();
  // category inference
  if(tokens.some(t=>['shoe','sneaker','running'].includes(t))) list = list.filter(p=>p.cat==='shoes');
  if(tokens.includes('jacket') || tokens.includes('outerwear')) list = list.filter(p=>p.cat==='outerwear');
  if(tokens.includes('hoodie')) list = list.filter(p=>p.title.toLowerCase().includes('hoodie'));
  if(tokens.includes('denim')) list = list.filter(p=>/denim/i.test(p.title)||/denim/i.test(p.desc));
  if(budget) list = list.filter(p=>p.price <= budget);
  // sort by relevance to full query
  list = list.map(p=>({p, s:relevance(p,q)})).sort((a,b)=>b.s-a.s).map(x=>x.p).slice(5?0:0, 5);
  return list.slice(0,5);
}
function compareItems(q){
  // crude: if ‚Äúvs‚Äù present, pick top 2 relevant
  if(!/\bvs\b|compare/i.test(q)) return null;
  const ranked = PRODUCTS.map(p=>({p, s:relevance(p,q)})).sort((a,b)=>b.s-a.s).slice(0,2).map(x=>x.p);
  if(ranked.length<2) return null;
  const [a,b] = ranked;
  return `Compare:
- ${a.title}: ${priceFmt(a.price)} ‚Äî ${a.desc}
- ${b.title}: ${priceFmt(b.price)} ‚Äî ${b.desc}
My take: ${a.title} suits ${a.cat==='shoes'?'active use':'cooler weather'}, while ${b.title} is better for ${b.cat==='outerwear'?'layering and wind':'style versatility'}.`;
}
function onChatSend(){
  const q = chatInput.value.trim(); if(!q) return;
  pushMsg('user', q); chatInput.value='';
  // Compare path
  const cmp = compareItems(q);
  if(cmp){ pushMsg('bot', cmp); return; }
  // Recommend path
  const recs = recommendFromQuery(q);
  if(recs.length){
    const lines = recs.map(p=>`‚Ä¢ ${p.title} ‚Äî ${priceFmt(p.price)}`).join('<br>');
    pushMsg('bot', `Here are good fits:<br>${lines}<br><brWant me to filter further by color or category?`);
  }else{
    pushMsg('bot', 'I could not find a great match. Try adding a category or a budget number.');
  }
}
chatSend.onclick = onChatSend;
chatInput.addEventListener('keydown', e=>{ if(e.key==='Enter') onChatSend(); });

/* ====== Init ====== */
function init(){
  skeletonCards(grid, 8);
  setTimeout(()=>{ runSearch(); renderTrending(); renderSimilar(); }, 250);
}
init();
</script>
</body>
</html> 